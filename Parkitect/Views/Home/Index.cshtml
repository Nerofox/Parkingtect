@{
    ViewBag.Title = "Home Page";
}

<div class="row">
    <div class="col-md-12">
        <h2>Carte des parkings rennaise</h2>
        <div id="map"></div>
        </div>
    </div>
</div>

<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoibmVyb2ZveCIsImEiOiJjamR1MDVnMXAyaGEwMnFxcGNvYWJ2cjByIn0.to1lq16P7bPjs0bUn4gUjg';
    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/mapbox/streets-v9', // stylesheet location
        center: [-1.650369, 48.109998], // starting position [lng, lat]
        zoom: 11.70801835251593 // starting zoom
    });

    $(document).ready(function () {
        //load parking in map
        $.get("/ApiParking/List", function (data) {
            data = JSON.parse(data);

            for (var i = 0; i < data.length; i++) {
                // create the popup
                var popup = new mapboxgl.Popup().setHTML("Nom : " + data[i].Name + "<br>Place libre : " + data[i].FreePlace + "<br>Place max : " + data[i].MaxPlace);

                // create DOM element for the marker
                var el = document.createElement('div');
                el.className = 'marker';

                // create the marker
                new mapboxgl.Marker(el)
                    .setLngLat(data[i].Geometry.coordinates)
                    .setPopup(popup) // sets a popup on this marker
                    .addTo(map);
            }
        });
    });
</script>